<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Questionnaire d'Impact - Multi-Activit√©</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#007bff">
  <link rel="stylesheet" href="styles.css">
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

  <style>
    /* Styles sp√©cifiques pour le formulaire (Doit √™tre en harmonie avec styles.css) */
    body { 
        background-color: var(--bg); 
        display: flex; 
        justify-content: center; 
        align-items: flex-start; 
        min-height: 100vh; 
        padding: var(--spacing-md); 
    }
    #questionnaire-form { 
        background: var(--card); 
        padding: var(--spacing-lg); 
        border-radius: var(--radius); 
        box-shadow: var(--shadow); 
        max-width: 800px; 
        width: 100%; 
        margin-top: 30px; 
        margin-bottom: 50px; 
    }
    h2, h3 { 
        color: var(--primary); 
        border-bottom: 1px solid #eee; 
        padding-bottom: 10px; 
        margin-bottom: 20px; 
    }
    .question-group { 
        margin-bottom: 30px; 
        padding: 15px; 
        border: 1px solid #f0f0f0; 
        border-radius: var(--radius-sm); 
    }
    .question-group h4 { 
        margin-top: 0; 
        color: var(--accent); 
    }
    .input-field, .select-field { 
        margin-bottom: 20px; 
    }
    .input-field label, .select-field label { 
        display: block; 
        margin-bottom: 8px; 
        font-weight: 600; 
        color: var(--text); 
    }
    .input-field input[type="text"], .input-field input[type="number"], .input-field select, .input-field textarea,
    .select-field input[type="text"], .select-field input[type="number"], .select-field select, .select-field textarea {
      width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: var(--radius-sm); font-size: 1rem;
    }
    .option-group.scale-1-5, .option-group.nps-scale { 
        display: flex; 
        flex-wrap: wrap; 
        gap: 5px; 
        justify-content: space-between;
    }
    .option-group label { 
        background: #f8f9fa; 
        padding: 10px 15px; 
        border: 1px solid #dee2e6; 
        border-radius: var(--radius-sm); 
        cursor: pointer; 
        transition: background 0.2s; 
        flex-grow: 1; 
        text-align: center;
        min-width: 30px; /* Pour les petites √©chelles */
    }
    .nps-scale label {
        min-width: 45px; /* Ajustement pour la taille 0-10 */
    }
    .option-group input[type="radio"]:checked + label, .option-group input[type="checkbox"]:checked + label { 
        background: var(--primary); 
        color: white; 
        border-color: var(--primary); 
    }
    .option-group input[type="radio"], .option-group input[type="checkbox"] { 
        display: none; 
    }
    .form-actions { 
        margin-top: 30px; 
        text-align: right; 
    }
    .required-star { 
        color: var(--danger); 
    }
    #notification-area {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        width: 100%;
        max-width: 400px;
    }
  </style>
</head>
<body>
  
  <div id="notification-area"></div>

  <form id="questionnaire-form">
    <h2>üìù Enregistrement d'une R√©ponse d'Impact</h2>
    <p class="muted mb-10">Veuillez remplir tous les champs requis (<span class="required-star">*</span>).</p>

    <div class="question-group" style="background: #fff3cd; border-left: 4px solid #ffc107;">
      <h4>‚ö†Ô∏è Dossier de sauvegarde</h4>
      <p class="muted">Les r√©ponses seront enregistr√©es dans le dossier projet.</p>
      
      <div id="folder-selection-status" style="margin: 15px 0;">
        <div class="status-box" style="display: inline-flex; align-items: center; gap: 8px; padding: 8px 15px; background: #f8d7da; border-radius: 8px;">
          <span class="status-indicator inactive"></span>
          <span id="folder-name-display">Aucun dossier s√©lectionn√©</span>
        </div>
        <button type="button" class="btn primary" id="select-folder-btn" style="margin-left: 10px;">
          üìÅ S√©lectionner le dossier projet
        </button>
      </div>
    </div>

    <div class="question-group">
      <h4>1. Session et Type d'Activit√©</h4>
      
      <div class="select-field">
        <label for="activity-type">Activit√© / Projet <span class="required-star">*</span></label>
        <select id="activity-type" name="activity_type" required>
          <option value="" disabled selected>Choisir une activit√©...</option>
        </select>
      </div>

      <div class="select-field">
        <label for="questionnaire-phase">Phase du Questionnaire <span class="required-star">*</span></label>
        <select id="questionnaire-phase" name="questionnaire_phase" required>
          <option value="" disabled selected>Choisir une phase...</option>
        </select>
      </div>

      <div class="input-field">
        <label for="participant-id">ID Participant <span class="required-star">*</span></label>
        <input type="text" id="participant-id" name="participant_id" placeholder="Ex: P-001" required />
      </div>
      
      <div class="input-field">
        <label for="session-id">ID Session / Groupe (Optionnel)</label>
        <input type="text" id="session-id" name="session_id" placeholder="Ex: S-Hiver-2025" />
      </div>
    </div>

    <div class="question-group">
      <h4>2. D√©mographie <span class="required-star">*</span></h4>
      
      <div class="input-field">
        <label for="age">√Çge <span class="required-star">*</span></label>
        <input type="number" id="age" name="age" min="15" max="100" required />
      </div>
      
      <div class="select-field">
        <label for="genre">Genre <span class="required-star">*</span></label>
        <select id="genre" name="genre" required>
            <option value="" disabled selected>Choisir...</option>
            <option value="Feminin">F√©minin</option>
            <option value="Masculin">Masculin</option>
            <option value="Non_genr√©">Non-genr√©</option>
            <option value="Prefere_ne_pas_repondre">Pr√©f√®re ne pas r√©pondre</option>
        </select>
      </div>
      
      <!-- ‚ú® NOUVEAU : Champ Origine -->
      <div class="select-field">
        <label for="origine">Origine <span class="required-star">*</span></label>
        <select id="origine" name="origine" required>
            <option value="" disabled selected>Choisir...</option>
            <option value="Fran√ßaise (ou Union Europ√©enne)">Fran√ßaise / Union Europ√©enne</option>
            <option value="√âtrang√®re (hors Union Europ√©enne)">Hors Union Europ√©enne</option>
            <option value="Pr√©f√®re ne pas r√©pondre">Pr√©f√®re ne pas r√©pondre</option>
        </select>
      </div>
      
      <div class="select-field">
        <label for="statut_professionnel">Statut Professionnel <span class="required-star">*</span></label>
        <select id="statut_professionnel" name="statut_professionnel" required>
            <option value="" disabled selected>Choisir...</option>
            <option value="Employe_Salarie">Employ√© / Salari√©</option>
            <option value="Independant">Ind√©pendant</option>
            <option value="Etudiant">√âtudiant</option>
            <option value="Retraite">Retrait√©</option>
            <option value="Sans_emploi">Sans emploi</option>
            <option value="Autre">Autre / Non sp√©cifi√©</option>
        </select>
      </div>
      
      <!-- ‚ú® NOUVEAU : Champ Niveau d'√âtudes -->
      <div class="select-field">
        <label for="niveau_etudes">Niveau d'√âtudes <span class="required-star">*</span></label>
        <select id="niveau_etudes" name="niveau_etudes" required>
            <option value="" disabled selected>Choisir...</option>
            <option value="Primaire / Secondaire">Primaire / Secondaire</option>
            <option value="Post-secondaire / Technique">Post-secondaire / Technique (CAP, BEP, etc.)</option>
            <option value="Universitaire (Bac / Licence)">Universitaire (Bac / Licence)</option>
            <option value="Universitaire (Master / Doctorat)">Universitaire (Master / Doctorat)</option>
            <option value="Pr√©f√®re ne pas r√©pondre">Pr√©f√®re ne pas r√©pondre</option>
        </select>
      </div>
      
      <div class="input-field">
        <label for="code-postal">Code Postal (pour analyse g√©ographique)</label>
        <input type="text" id="code-postal" name="code_postal" placeholder="Ex: 75001" />
      </div>
    </div>
    
    <div class="question-group">
      <h4>3. Indicateurs Transversaux</h4>
      
      <div class="input-field">
        <label>Autonomie per√ßue (1: Tr√®s faible √† 5: Tr√®s forte) <span class="required-star">*</span></label>
        <div class="option-group scale-1-5" id="autonomie-group">
          <input type="radio" id="autonomie_1" name="autonomie_percue" value="1" required><label for="autonomie_1">1</label>
          <input type="radio" id="autonomie_2" name="autonomie_percue" value="2"><label for="autonomie_2">2</label>
          <input type="radio" id="autonomie_3" name="autonomie_percue" value="3"><label for="autonomie_3">3</label>
          <input type="radio" id="autonomie_4" name="autonomie_percue" value="4"><label for="autonomie_4">4</label>
          <input type="radio" id="autonomie_5" name="autonomie_percue" value="5"><label for="autonomie_5">5</label>
        </div>
      </div>
      
      <div class="input-field">
        <label>Confiance en soi (1: Tr√®s faible √† 5: Tr√®s forte) <span class="required-star">*</span></label>
        <div class="option-group scale-1-5" id="confiance-group">
          <input type="radio" id="confiance_1" name="confiance_en_soi" value="1" required><label for="confiance_1">1</label>
          <input type="radio" id="confiance_2" name="confiance_en_soi" value="2"><label for="confiance_2">2</label>
          <input type="radio" id="confiance_3" name="confiance_en_soi" value="3"><label for="confiance_3">3</label>
          <input type="radio" id="confiance_4" name="confiance_en_soi" value="4"><label for="confiance_4">4</label>
          <input type="radio" id="confiance_5" name="confiance_en_soi" value="5"><label for="confiance_5">5</label>
        </div>
      </div>
    </div>

    <div class="question-group hidden" id="specific-section">
      <h4>4. Indicateurs Sp√©cifiques (<span id="specific-activity-label">Activit√©</span>)</h4>
      <div id="specific-questions">
        <p>S√©lectionnez une activit√© et une phase pour voir les questions sp√©cifiques.</p>
      </div>
    </div>

    <div class="question-group">
      <h4>5. Satisfaction et Remarques</h4>
      
      <div class="input-field">
        <label>Satisfaction globale (1: Tr√®s insatisfait √† 5: Tr√®s satisfait) <span class="required-star">*</span></label>
        <div class="option-group scale-1-5" id="satisfaction-group"></div>
      </div>
      
      <div class="input-field">
        <label>Recommanderiez-vous notre association/activit√© ? (NPS 0-10) <span class="required-star">*</span></label>
        <div class="option-group nps-scale" id="nps-group"></div>
      </div>
      
      <div class="input-field">
        <label for="remarques">Remarques et Commentaires (Ouvert)</label>
        <textarea id="remarques" name="remarques_ouvertes" rows="4" placeholder="Partagez votre exp√©rience, vos suggestions..."></textarea>
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn primary" id="submit-form">‚úì Enregistrer les R√©ponses</button>
    </div>
  </form>

  <script src="config.js"></script>
  <script src="questionnaire.js"></script>
  
</body>
</html>